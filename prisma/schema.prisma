// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Category {
  id          String   @id @default(cuid())
  name        String   @unique
  description String?
  slug        String   @unique
  image       String?
  order       Int      @default(0)
  isActive    Boolean  @default(true)
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  artListings ArtListing[]
}

model ArtListing {
  id          String   @id @default(cuid())
  title       String
  description String
  price       Float
  categoryId  String
  category    Category @relation(fields: [categoryId], references: [id])
  material    String?  // Wood type, fabric type, etc. (optional, category-specific)
  region      String
  size        String
  images      String[] // Array of image URLs
  featured    Boolean  @default(false)
  
  // Artisan relation (optional - not all listings need an artisan)
  artisanId   String?
  artisan     Artisan? @relation(fields: [artisanId], references: [id])
  
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  orderRequests OrderRequest[]
}

model OrderRequest {
  id          String   @id @default(cuid())
  name        String
  email       String
  location    String
  message     String?
  status      String   @default("pending") // pending, approved, shipped, delivered, cancelled
  userId      String?  // Clerk user ID
  artListingId String
  artListing  ArtListing @relation(fields: [artListingId], references: [id])
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
}

model User {
  id       String   @id @default(cuid())
  clerkId  String   @unique
  role     String   @default("user")
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model BlogPost {
  id          String   @id @default(cuid())
  title       String
  slug        String   @unique
  excerpt     String
  content     String
  category    String
  author      String
  authorTitle String?
  authorImage String?
  date        DateTime
  image       String?
  tags        String[]
  featured    Boolean  @default(false)
  allowComments Boolean @default(true)
  status      String   @default("draft") // draft, published
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
}

model TeamMember {
  id          String   @id @default(cuid())
  name        String
  title       String
  bio         String
  image       String
  order       Int      @default(0)
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
}

// Artisan Registration Status
enum ArtisanStatus {
  PENDING      // Awaiting admin approval
  APPROVED     // Approved, can manage shop
  REJECTED     // Rejected by admin
}

// Artisan Model for Multi-Vendor Marketplace
model Artisan {
  id              String   @id @default(cuid())
  
  // Authentication
  email           String   @unique
  clerkId         String?  @unique  // For authentication
  
  // Registration Details
  fullName        String
  phone           String?
  specialty       String   // e.g., "Beadwork", "Woodcarving", "Textiles", "Jewelry", "Paintings"
  region          String
  location        String?  // Village/city
  yearsExperience Int?
  
  // Shop Details (set after approval)
  shopName        String?  @unique
  shopSlug        String?  @unique
  shopBio         String?  @db.Text
  shopLogo        String?
  shopBanner      String?
  
  // Social Links
  website         String?
  instagram       String?
  facebook        String?
  whatsapp        String?
  
  // Approval
  status          ArtisanStatus @default(PENDING)
  rejectionReason String?
  approvedAt      DateTime?
  approvedBy      String?
  
  // Verification
  isVerified      Boolean  @default(false)
  
  // Relations
  artListings     ArtListing[]
  
  // Timestamps
  createdAt       DateTime @default(now())
  updatedAt       DateTime @updatedAt
}
